{% extends "layout.html" %}

{% block content %}

<h4 style="margin: 0 0 10px 0; font-size: 18px;">Performans Özeti</h4>
<div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 20px;">
    
    <div class="ios-card" style="text-align: center; padding: 20px;">
        <i class="fas fa-layer-group" style="font-size: 24px; color: var(--primary); margin-bottom: 8px;"></i>
        <div style="font-size: 28px; font-weight: 800;">{{ total }}</div>
        <div style="font-size: 12px; color: var(--text-sec);">Toplam Set</div>
    </div>

    <div class="ios-card" style="text-align: center; padding: 20px;">
        <i class="fas fa-heart" style="font-size: 24px; color: var(--danger); margin-bottom: 8px;"></i>
        <div style="font-size: 20px; font-weight: 800; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">{{ fav }}</div>
        <div style="font-size: 12px; color: var(--text-sec);">Favori Bölge</div>
    </div>
</div>

<h4 style="margin: 0 0 10px 0; font-size: 18px;">Kas Grubu Dağılımı</h4>
<div class="ios-card" style="padding: 20px;">
    <canvas id="muscleChart"></canvas>
</div>

<div class="ios-card" style="margin-top: 20px; display: flex; align-items: center; justify-content: space-between;">
    <div>
        <div style="font-weight: 600;">Supplement Disiplini</div>
        <div style="font-size: 12px; color: var(--text-sec);">Son 30 günde alınan dozaj</div>
    </div>
    <div style="font-size: 24px; font-weight: 800; color: var(--success);">{{ sup_score }}</div>
</div>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
    const ctx = document.getElementById('muscleChart').getContext('2d');
    
    // Backend'den gelen veriler
    const labels = {{ chart_labels | tojson }};
    const data = {{ chart_data | tojson }};

    if (labels.length === 0) {
        // Veri yoksa boş mesaj
        ctx.font = "14px Arial";
        ctx.fillStyle = "white";
        ctx.fillText("Henüz veri yok. Antrenman girin!", 50, 75);
    } else {
        new Chart(ctx, {
            type: 'doughnut',
            data: {
                labels: labels,
                datasets: [{
                    data: data,
                    backgroundColor: [
                        '#0A84FF', '#30D158', '#FF453A', '#BF5AF2', 
                        '#FF9F0A', '#64D2FF', '#FFD60A', '#AC8E68'
                    ],
                    borderWidth: 0
                }]
            },
            options: {
                responsive: true,
                plugins: {
                    legend: {
                        position: 'right',
                        labels: { color: '#8E8E93', boxWidth: 10 }
                    }
                }
            }
        });
    }
</script>

{% endblock %}